{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "ls_config_v1.schema.json",
  "title": "ls_config_v1",
  "type": "object",
  "additionalProperties": false,
  "required": ["schema", "defaults", "caps", "policy"],
  "properties": {
    "schema": {
      "type": "string",
      "const": "ls_config_v1",
      "description": "Document discriminator for ls config (v1)."
    },
    "defaults": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "root",
        "depth",
        "include_hidden",
        "sort",
        "order",
        "top_n",
        "git_status"
      ],
      "properties": {
        "root": { "type": "string", "minLength": 1 },
        "depth": { "type": "integer", "minimum": 0, "maximum": 128 },
        "include_hidden": { "type": "boolean" },
        "sort": { "type": "string", "enum": ["mtime", "size", "name"] },
        "order": { "type": "string", "enum": ["asc", "desc"] },
        "top_n": { "type": "integer", "minimum": 1, "maximum": 100000 },
        "git_status": { "type": "string", "enum": ["auto", "enabled", "disabled"] }
      }
    },
    "caps": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "max_depth",
        "max_entries_scanned",
        "max_top_n",
        "max_view_bytes",
        "max_assumptions"
      ],
      "properties": {
        "max_depth": { "type": "integer", "minimum": 0, "maximum": 128 },
        "max_entries_scanned": { "type": "integer", "minimum": 1, "maximum": 1000000 },
        "max_top_n": { "type": "integer", "minimum": 1, "maximum": 100000 },
        "max_view_bytes": { "type": "integer", "minimum": 1, "maximum": 10485760 },
        "max_assumptions": { "type": "integer", "minimum": 0, "maximum": 64 }
      }
    },
    "policy": {
      "type": "object",
      "additionalProperties": false,
      "required": ["follow_symlinks", "gitignore"],
      "properties": {
        "follow_symlinks": { "type": "boolean" },
        "gitignore": {
          "type": "object",
          "additionalProperties": false,
          "required": ["mode"],
          "properties": {
            "mode": { "type": "string", "enum": ["git_only", "none"] }
          }
        }
      }
    }
  }
}
